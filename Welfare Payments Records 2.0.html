<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Welfare Payment Tracker</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
        }

        * {
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }

        .admin-menu {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        .menu-icon {
            font-size: 24px;
            cursor: pointer;
            color: var(--primary-color);
        }

        .admin-panel {
            display: none;
            position: absolute;
            right: 0;
            background: white;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            border-radius: 5px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-color);
        }

        .search-container {
            margin: 20px 0;
            text-align: center;
        }

        #searchInput {
            padding: 10px;
            width: 80%;
            max-width: 400px;
            border: 2px solid var(--secondary-color);
            border-radius: 25px;
        }

        .table-container {
            overflow-x: auto;
        }

        .payment-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .payment-table th {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            position: sticky;
            left: 0;
        }

        .payment-table td, .payment-table th {
            padding: 12px;
            border: 1px solid #ddd;
            min-width: 120px;
        }

        .family-header {
            background: var(--secondary-color) !important;
            font-weight: bold;
            font-size: 1.1em;
        }

        .paid {
            background: #2ecc71;
            cursor: pointer;
        }

        .quote {
            text-align: center;
            margin-top: 30px;
            font-style: italic;
            color: var(--primary-color);
            padding: 20px;
            border-top: 2px solid var(--secondary-color);
        }

        .download-btn {
            display: block;
            margin: 20px auto;
            padding: 12px 25px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .add-buttons {
            text-align: center;
            margin: 20px 0;
        }

        .admin-control {
            display: none;
        }
    </style>
</head>
<body>
    <div class="admin-menu">
        <div class="menu-icon" onclick="toggleAdmin()">â˜°</div>
        <div class="admin-panel" id="adminPanel">
            <input type="password" id="adminPass" placeholder="Admin Password">
            <button onclick="enableEditing()">Login</button>
            <div class="admin-control" id="adminControls">
                <button onclick="showAddMemberForm()">Add Member</button>
                <button onclick="addMonthColumn()">Add Month</button>
            </div>
        </div>
    </div>

    <div class="header">
        <h1>Family Welfare Payment Tracker</h1>
        <p>March 2025 Onwards</p>
    </div>

    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search member name..." onkeyup="searchMembers()">
    </div>

    <div class="table-container">
        <table class="payment-table" id="paymentTable">
            <!-- Table content generated by JavaScript -->
        </table>
    </div>

    <button class="download-btn" onclick="exportData()">Download CSV</button>

    <div class="quote">
        "Family is not an important thing. It's everything." - Michael J. Fox
    </div>

    <!-- Add Member Form -->
    <div id="addMemberForm" style="display:none;">
        <h3>Add New Member</h3>
        <input type="text" id="newMemberName" placeholder="Member Name">
        <select id="familySelect">
            <option value="HUSSEIN'S FAMILY">HUSSEIN'S FAMILY</option>
            <option value="THOMAS'S FAMILY">THOMAS'S FAMILY</option>
            <option value="NYAMBU'S FAMILY">NYAMBU'S FAMILY</option>
            <option value="BARAZA'S FAMILY">BARAZA'S FAMILY</option>
            <option value="HAMISI'S FAMILY">HAMISI'S FAMILY</option>
            <option value="MWAKOTO'S FAMILY">MWAKOTO'S FAMILY</option>
        </select>
        <button onclick="addNewMember()">Add</button>
    </div>

    <script>
        // Initialize data with all provided members
        const families = {
            "HUSSEIN'S FAMILY": [
                "Dorothy Wawuda", "Meshack Hamisi", "Evans Kisombe", "Janeth Wawuda",
                "Ali Wawuda", "Mnjala Wawuda", "David Ngongodi", "Hussein Ngongodi",
                "Japheth Ngongodi", "Lydiah Kisombe", "Esther Day", "Danson Kisombe",
                "Evans Mwanyumba", "Patrick Mbekelu", "James Warindo"
            ],
            "THOMAS'S FAMILY": [
                "Priscilla Thomas", "Madeline Wawuda", "Joseph Mwashumbe",
                "William Mwang'ombe", "Humphrey Mwamburi", "Serianah Mghoi",
                "Julias Mwawasi", "Ronald Mbinga", "Japheth kisaka", "Priscilla Samba",
                "Reginald Kisombe", "Metabellah Sau", "Erick Mwadime", "Wilson Mwang'ombe",
                "Charity Zighe", "Danman Kiteto", "Priscilla Kiteto", "Mangi Kiteto",
                "Thomas Kiteto", "Francis Kiteto", "Titus Mwawaka", "Dorcas Skayo",
                "Erick Kighombe", "Priscilla Kighombe", "Thomas Kighombe", "Nyambu Thomas",
                "Jedidah Kawuki", "Brian Kisombe"
            ],
            "NYAMBU'S FAMILY": [
                "Nancy Kililo", "Alice Wache", "John Nyambu", "Bahati Mkaluma",
                "Shaban Mwasambo", "Said Mwasambo", "Harun Mwasambo", "Rophus Mwasambo",
                "Dorothy Nyambu", "Anthony Nyambu", "Brian Malombo", "Harun Nyambu",
                "Magie Mwambela", "Nyambu Mwambela", "Nancy Mwambela", "Crispine Nyambu",
                "Allen Nyambu", "Michael Allen", "Patrick Nyambu"
            ],
            "BARAZA'S FAMILY": [
                "Rashid Mwakoto", "Rose Wawuda", "Richard Baraza", "Shaban Rashid",
                "Richard Mwanginda", "Alloice Shaban", "Mary Wakio", "Richard Wakio",
                "Mchoki Rashid", "Mark Rashid", "Nancy Kililo", "Shaban Mulinge",
                "Saumu Wanyika", "Elizabeth Mkaluma", "Jefason Mwambota", "Joyce Rashid"
            ],
            "HAMISI'S FAMILY": [
                "Hamisi Makuka", "Mwanaidi Hamisi", "Winnie Mkamburi", "Rose Hamisi",
                "Makuka Rose", "Kadzo Hamisi", "Jeremiah Kilelu", "Jotham Nyambu",
                "Jane Nyambu", "Robin Hamisi", "Paul Hamisi", "Wakio Hamisi",
                "Mwanasiti Hamisi", "Wawuda Hamisi"
            ],
            "MWAKOTO'S FAMILY": [
                "Amos Mwakoto", "Jackson Nyambu", "Hezron Kibai", "Norman Mwamburi",
                "Josepat Mwarinda", "Oliver kilelu", "Hannah Mkandoo", "Agnes Mwakoto",
                "Samson Nzuki", "Stephen Mwakoto", "Jackson Nyambu", "Charity kulola",
                "Margaret Kakwasi", "Joyce Bibi", "Nancy Mwakoto", "Josephine Mwakoto",
                "Sambo Kilelu", "Sabina Kilelu", "Victoria Kilelu", "Ezekiel Nyambu",
                "Heri Kibai"
            ]
        };

        let isAdmin = false;
        let months = generateMonths();

        function generateMonths() {
            const months = [];
            const start = new Date(2025, 2); // March 2025
            for(let i = 0; i < 12; i++) {
                months.push(new Date(start.getFullYear(), start.getMonth() + i).toLocaleString('default', { month: 'long', year: 'numeric' }));
            }
            return months;
        }

        function createTable() {
            const table = document.getElementById('paymentTable');
            let html = '<tr><th>Member Name</th>';
            
            months.forEach(month => {
                html += `<th>${month}</th>`;
            });
            html += '</tr>';

            for(const [family, members] of Object.entries(families)) {
                html += `<tr class="family-header"><td colspan="${months.length + 1}">${family}</td></tr>`;
                members.forEach(member => {
                    html += `<tr><td>${member}</td>`;
                    for(let i = 0; i < months.length; i++) {
                        html += `<td class="${localStorage.getItem(`${member}-${months[i]}`) ? 'paid' : ''}" 
                               onclick="handlePayment('${member}', '${months[i]}')"></td>`;
                    }
                    html += '</tr>';
                });
            }

            table.innerHTML = html;
        }

        function handlePayment(member, month) {
            if(!isAdmin) return;
            const cell = document.querySelector(`td[onclick="handlePayment('${member}', '${month}')"]`);
            cell.classList.toggle('paid');
            localStorage.setItem(`${member}-${month}`, cell.classList.contains('paid'));
        }

        function searchMembers() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#paymentTable tr');
            
            rows.forEach(row => {
                const name = row.cells[0]?.textContent.toLowerCase();
                row.style.display = name?.includes(input) ? '' : 'none';
            });
        }

        function toggleAdmin() {
            const panel = document.getElementById('adminPanel');
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
        }

        function enableEditing() {
            const password = document.getElementById('adminPass').value;
            if(password === 'Admin@123') {
                isAdmin = true;
                document.getElementById('adminControls').style.display = 'block';
                alert('Admin mode activated');
            }
        }

        function showAddMemberForm() {
            document.getElementById('addMemberForm').style.display = 'block';
        }

        function addNewMember() {
            const memberName = document.getElementById('newMemberName').value;
            const family = document.getElementById('familySelect').value;
            if(memberName && families[family]) {
                families[family].push(memberName);
                createTable();
                document.getElementById('addMemberForm').style.display = 'none';
            }
        }

        function addMonthColumn() {
            const lastDate = new Date(months[months.length-1]);
            const newMonth = new Date(lastDate.getFullYear(), lastDate.getMonth() + 1);
            months.push(newMonth.toLocaleString('default', { month: 'long', year: 'numeric' }));
            createTable();
        }

        function exportData() {
            let csv = 'Member Name,' + months.join(',') + '\n';
            for(const [family, members] of Object.entries(families)) {
                members.forEach(member => {
                    const payments = months.map(month => 
                        localStorage.getItem(`${member}-${month}`) ? 'Paid' : '');
                    csv += `${member},${payments.join(',')}\n`;
                });
            }
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'payment-records.csv';
            a.click();
        }

        window.onload = createTable;
    </script>
</body>
</html>
